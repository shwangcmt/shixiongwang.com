/* Smooth scrolling for TOC navigation */
html {
    scroll-behavior: smooth;
}

:root {
    /* Override the default Starlight font variable to use Source Serif 4 by default (for body and headings) */
    --sl-font: 'Source Serif 4 Variable', 'Source Serif 4', serif;

    /* Define a variable for our UI font (Source Sans 3) */
    --sl-font-ui: 'Source Sans 3 Variable', 'Source Sans 3', sans-serif;

    /* Update Heading Sizes to match User Request (Very Compact) */
    --sl-text-h1: 1.5rem;
    --sl-text-h2: 1.2rem;
    --sl-text-h3: 1rem;
    --sl-text-h4: 0.95rem;
    --sl-text-h5: 0.9rem;

    /* Sidebar Dimensions & Behavior */
    --u-sidebar-max: 19rem;
    /* Original wide width (~304px) */
    --u-sidebar-min: 12.5rem;
    /* Minimum safe width (~200px) */

    /* 
       Mobile/Tablet Default:
       Sidebar starts FIXED at max (19rem) as long as there is whitespace.
       It only starts shrinking when (Viewport - 42rem) < 19rem (approx 976px).
       It hits floor (12.5rem) at approx 800px.
       This preserves ~42rem (672px) for content + padding at all costs.
    */
    --sl-sidebar-width: clamp(var(--u-sidebar-min), calc(100vw - 42rem), var(--u-sidebar-max));

    /* 
       TOC Fluid Width (for Desktop):
       Shrinks at 20vw to collapse visually before the sidebar.
    */
    --sl-toc-width: clamp(var(--u-sidebar-min), 20vw, var(--u-sidebar-max));
}

/* 
   Desktop Override (Width > 72rem / 1152px):
   Starlight shows both sidebars here.
   Regulation: Keep Left Sidebar FIXED (Max), Let TOC Shrink (Fluid).
*/
@media (min-width: 72rem) {
    :root {
        --sl-sidebar-width: var(--u-sidebar-max);
        /* Lock Left Sidebar */
    }

    /* Override Starlight Grid to use separate widths */
    .page {
        grid-template-columns: var(--sl-sidebar-width) 1fr var(--sl-toc-width) !important;
    }
}

/* Reduce spacing between sections (Compact Margins) */
.sl-markdown-content h1,
.sl-markdown-content h2,
.sl-markdown-content h3,
.sl-markdown-content h4 {
    margin-top: 1em !important;
    /* Tighter spacing (1em) */
    margin-bottom: 0.6em !important;
}

/* Enforce Semi-Bold (600) for all headings, and Italic for H3 */
h1,
h2,
h3,
h4,
h5,
h6 {
    font-weight: 600 !important;
}

h3 {
    font-style: italic;
}

/* Override bold text to use semi-bold (600) per user preference */
strong,
b {
    font-weight: 600;
}

/* Apply Sans-Serif font to UI elements */
.header,
.sidebar,
.right-sidebar,
starlight-menu-button,
.sl-steps,
.sl-markdown-content .sl-badge {
    font-family: var(--sl-font-ui);
}

/* Site title styling to match Flexoki default (larger, bolder) */
:root .site-title,
:root .site-title span,
.header .site-title,
.header .site-title span,
a.site-title,
a.site-title span {
    font-size: 1.5rem !important;
    font-weight: 600 !important;
    line-height: 1.2 !important;
}

/* Increase font size for Right Sidebar (Table of Contents) */
/* Increase font size for Right Sidebar (Table of Contents) */
.right-sidebar a {
    font-size: 0.9375rem;
    /* ~15px */
    padding-block: 0.4em;
    /* Increased spacing per user request */
    transition: color 0.15s ease, border-left 0.15s ease;
}

/* Active Highlight for Right Sidebar (Current Section) & Mobile TOC */
/* Active Highlight for Right Sidebar (Current Section) & Mobile TOC */
.right-sidebar a[aria-current="true"],
starlight-toc a[aria-current="true"],
.mobile-starlight-toc a[aria-current="true"] {
    color: var(--sl-color-accent-high);
    font-weight: 600;
    position: relative;
    background-color: transparent;
    /* Remove direct background */
    border: none;
    isolation: isolate;
    /* Ensure z-index works correctly */
}

.right-sidebar a[aria-current="true"]::before,
starlight-toc a[aria-current="true"]::before,
.mobile-starlight-toc a[aria-current="true"]::before {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    left: -0.5rem;
    /* Visual space before text */
    right: 0;
    /* Fill to the right edge of the container */
    /* Fill to the right edge of the container */
    background-color: var(--sl-color-accent-low);
    border-radius: 4px;
    z-index: -1;
}

/* Ensure the TOC content has a safety margin from the browser edge 
   We apply this to the internal container (starlight-toc) instead of the sidebar itself
   to avoid breaking the Starlight grid layout. */
starlight-toc {
    display: block;
    margin-right: 1.5rem !important;
}

/* Ensure links fill the container so highlight matches width */
.right-sidebar a {
    display: block;
}

/* Hide default checkmark/icon in mobile TOC active item */
/* Hide default checkmark/icon in mobile TOC active item (SVG or pseudo-element) */
starlight-toc a[aria-current="true"] svg,
#starlight__mobile-toc a[aria-current="true"] svg,
#starlight__mobile-toc .dropdown a[aria-current="true"] svg,
#starlight__mobile-toc a svg,
#starlight__mobile-toc a[aria-current="true"]::after {
    display: none !important;
    content: none !important;
}


/* Strengthen background highlight for Light Mode in Mobile TOC */
:root[data-theme='light'] #starlight__mobile-toc a[aria-current="true"]::before {
    background-color: rgba(0, 0, 0, 0.08);
    /* Darker overlay for better visibility in light mode */
}

/* Remove all border separators in Mobile TOC dropdown to match desktop (clean) style */
#starlight__mobile-toc .dropdown,
#starlight__mobile-toc .dropdown a,
#starlight__mobile-toc details,
#starlight__mobile-toc .dropdown *,
mobile-starlight-toc .dropdown,
mobile-starlight-toc .dropdown a,
.dropdown.astro-doynk5tl,
.dropdown.astro-doynk5tl a,
a.astro-g2bywc46 {
    border: none !important;
    border-top: none !important;
    border-bottom: none !important;
    box-shadow: none !important;
}

/* Disable horizontal scrolling on Mobile TOC dropdown */
#starlight__mobile-toc .dropdown,
.dropdown.astro-doynk5tl {
    overflow-x: hidden !important;
    /* Add subtle shadow to lower boundary like official Starlight */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
}

/* Increase font size for Left Sidebar (Navigation) */
.sidebar-content a,
.sidebar-content summary {
    font-size: 0.9375rem;
    /* ~15px */
    white-space: normal;
    /* Ensure text wraps */
    overflow-wrap: anywhere;
    /* Break long words if necessary */
    line-height: 1.4;
    /* Improve readability of wrapped text */
    height: auto;
    /* Allow height to grow */
}

/* Active Highlight for Left Sidebar (Current Page) */
/* Active Highlight for Left Sidebar (Current Page) */
.sidebar-content a[aria-current="page"] {
    color: var(--sl-color-accent-high);
    font-weight: 600;
    position: relative;
    background-color: transparent;
    /* Remove direct background */
    border: none;
}

.sidebar-content a[aria-current="page"]::before {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    left: -0.5rem;
    /* Visual space before text */
    right: -0.5rem;
    background-color: var(--sl-color-accent-low);
    border-radius: 4px;
    z-index: -1;
}

/* Ensure code blocks still use mono if needed (Starlight usually handles this with --sl-font-mono) */
/* The Flexoki theme uses --sl-font-mono for code, which is fine. */

/* Make bold text in body Semi-Bold (600) instead of Bold (700) */
.content-panel strong,
.content-panel b,
.main-frame strong,
.main-frame b {
    font-weight: 600;
}

/* Slightly compact line spacing */
.content-panel,
.main-frame {
    --sl-line-height: 1.55;
    line-height: 1.55;
}

/* Hide heading anchor links by default on all devices (including mobile) */
.sl-markdown-content .sl-anchor-link {
    opacity: 0;
}

/* Ensure they only appear on focus or hover (desktop) */
.sl-markdown-content .sl-anchor-link:focus,
.sl-markdown-content .sl-heading-wrapper:hover .sl-anchor-link {
    opacity: 1;
}